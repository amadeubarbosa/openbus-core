local _G = require "_G"
local assert = _G.assert

local luaidl = require "luaidl"
local parse = luaidl.parse

local idlspec = [[
#include "fault_tolerance_service.idl"
#include "access_control_service.idl"
#include "registry_service.idl"
]]

local Compiler = require "oil.corba.idl.Compiler"
local options = Compiler().defaults
options.incpath = {
  os.getenv("OPENBUS_IDLLEGACY") or "idl/legacy",
  os.getenv("OPENBUS_SCSIDL") or "idl/scs",
}
return { assert(parse(idlspec, options)) }
